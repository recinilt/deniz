<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#1976D2">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="format-detection" content="telephone=no">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: blob: https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdnjs.cloudflare.com; img-src 'self' data: blob:;">
  <title>Ã–deme HatÄ±rlatÄ±cÄ±</title>
  <link rel="stylesheet" href="css/app.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
</head>
<body class="theme-light">

  <!-- ==================== LOADING SPLASH ==================== -->
  <div class="app-loading" id="app-loading">
    <div class="app-loading-spinner"></div>
  </div>

  <!-- ==================== HEADER ==================== -->
  <header class="app-header">
    <h1>ğŸ’° <span data-i18n="app_name">Ã–deme HatÄ±rlatÄ±cÄ±</span></h1>
    <div class="header-actions">
      <span class="premium-badge">â­ PRO</span>
    </div>
  </header>

  <!-- ==================== SAYFA: DASHBOARD ==================== -->
  <div class="page active" id="page-dashboard">

    <!-- Ã–zet KartlarÄ± -->
    <div class="dash-cards">
      <div class="dash-card card-total">
        <div class="dash-label" data-i18n="dash_this_month">Bu Ay Toplam</div>
        <div class="dash-value" id="dash-total">0 â‚º</div>
      </div>
      <div class="dash-card card-paid">
        <div class="dash-label" data-i18n="dash_paid_count">Ã–denen</div>
        <div class="dash-value" id="dash-paid">0 â‚º</div>
      </div>
      <div class="dash-card card-overdue">
        <div class="dash-label" data-i18n="filter_overdue">GecikmiÅŸ</div>
        <div class="dash-value" id="dash-overdue">0</div>
      </div>
      <div class="dash-card card-upcoming">
        <div class="dash-label" data-i18n="dash_upcoming">YaklaÅŸan</div>
        <div class="dash-value" id="dash-upcoming-count">0</div>
      </div>
    </div>

    <!-- Kalan Ã–deme HakkÄ± -->
    <div class="dash-remaining" id="dash-remaining" style="display:none;"></div>

    <!-- GecikmiÅŸ Ã–deme UyarÄ±sÄ± -->
    <div id="dash-overdue-alert"></div>

    <!-- YaklaÅŸan Ã–demeler -->
    <h2 class="section-title" data-i18n="dash_upcoming">YaklaÅŸan Ã–demeler</h2>
    <div id="dash-upcoming-list">
      <div class="empty-state"><p data-i18n="no_data">Veri bulunamadÄ±</p></div>
    </div>
  </div>

  <!-- ==================== SAYFA: Ã–DEMELER ==================== -->
  <div class="page" id="page-payments">

    <!-- Arama -->
    <div class="search-bar">
      <input type="text" data-i18n-placeholder="filter_search" placeholder="Ara..." oninput="handleSearch(this.value)">
    </div>

    <!-- Kategori Filtresi -->
    <div class="filter-bar" id="filter-category">
      <button class="filter-btn active" onclick="setFilter('category','all');activateFilter(this)" data-i18n="filter_all">TÃ¼mÃ¼</button>
      <button class="filter-btn" onclick="setFilter('category','fatura');activateFilter(this)">ğŸ“„ Fatura</button>
      <button class="filter-btn" onclick="setFilter('category','kredi');activateFilter(this)">ğŸ’³ Kredi</button>
      <button class="filter-btn" onclick="setFilter('category','vergi');activateFilter(this)">ğŸ›ï¸ Vergi</button>
      <button class="filter-btn" onclick="setFilter('category','arac');activateFilter(this)">ğŸš— AraÃ§</button>
      <button class="filter-btn" onclick="setFilter('category','sigorta');activateFilter(this)">ğŸ›¡ï¸ Sigorta</button>
      <button class="filter-btn" onclick="setFilter('category','abonelik');activateFilter(this)">ğŸ”„ Abonelik</button>
      <button class="filter-btn" onclick="setFilter('category','borc');activateFilter(this)">ğŸ¤ BorÃ§</button>
      <button class="filter-btn" onclick="setFilter('category','diger');activateFilter(this)">ğŸ“Œ DiÄŸer</button>
    </div>

    <!-- Durum Filtresi -->
    <div class="filter-bar" id="filter-status">
      <button class="filter-btn active" onclick="setFilter('status','all');activateFilter(this)" data-i18n="filter_all">TÃ¼mÃ¼</button>
      <button class="filter-btn" onclick="setFilter('status','pending');activateFilter(this)" data-i18n="filter_pending">Bekleyen</button>
      <button class="filter-btn" onclick="setFilter('status','overdue');activateFilter(this)" data-i18n="filter_overdue">GecikmiÅŸ</button>
      <button class="filter-btn" onclick="setFilter('status','partial');activateFilter(this)" data-i18n="filter_partial">KÄ±smi</button>
      <button class="filter-btn" onclick="setFilter('status','paid');activateFilter(this)" data-i18n="filter_paid">Ã–dendi</button>
    </div>

    <!-- Ã–deme Listesi -->
    <div id="payment-list">
      <div class="empty-state"><p data-i18n="no_data">Veri bulunamadÄ±</p></div>
    </div>
  </div>

  <!-- ==================== SAYFA: TAKVÄ°M ==================== -->
  <div class="page" id="page-calendar">
    <div class="calendar-header">
      <button class="cal-nav-btn" onclick="calendarPrev()">â—€</button>
      <h2 id="calendar-title">Åubat 2026</h2>
      <button class="cal-nav-btn" onclick="calendarNext()">â–¶</button>
    </div>
    <div class="calendar-grid" id="calendar-grid"></div>
  </div>

  <!-- ==================== SAYFA: RAPORLAR ==================== -->
  <div class="page" id="page-reports">

    <!-- Premium Overlay -->
    <div class="premium-overlay" id="reports-premium-overlay" style="display:none; position:relative; min-height:300px;">
      <div class="premium-overlay-content">
        <p>ğŸ”’ <span data-i18n="set_premium_desc">Premium Ã¶zellik</span></p>
        <button class="btn btn-premium best" onclick="showPremiumPrompt()">â­ Premium</button>
      </div>
    </div>

    <!-- AylÄ±k DaÄŸÄ±lÄ±m -->
    <h2 class="section-title" data-i18n="rep_monthly">AylÄ±k DaÄŸÄ±lÄ±m</h2>
    <div class="chart-container">
      <canvas id="chartMonthly"></canvas>
    </div>

    <!-- Trend -->
    <h2 class="section-title" data-i18n="rep_trend">6 AylÄ±k Trend</h2>
    <div class="chart-container">
      <canvas id="chartTrend"></canvas>
    </div>

    <!-- CSV Export -->
    <button class="btn btn-primary mt-16" onclick="shareCSV()" style="width:100%;">
      ğŸ“¤ <span data-i18n="rep_export_csv">CSV DÄ±ÅŸa Aktar</span>
    </button>

    <!-- Hesap Makineleri -->
    <h2 class="section-title mt-20" data-i18n="nav_calculators">Hesap Makineleri</h2>

    <!-- Kredi Hesaplama -->
    <div class="calc-section">
      <h3>ğŸ¦ <span data-i18n="calc_loan">Kredi Taksit Hesaplama</span></h3>
      <div class="form-group">
        <label data-i18n="calc_principal">Anapara (â‚º)</label>
        <input type="number" id="calc-loan-principal" placeholder="100000" min="0" step="1000">
      </div>
      <div class="form-row">
        <div class="form-group flex-1">
          <label data-i18n="calc_rate">YÄ±llÄ±k Faiz (%)</label>
          <input type="number" id="calc-loan-rate" placeholder="42" min="0" step="0.1">
        </div>
        <div class="form-group flex-1">
          <label data-i18n="calc_months">Vade (Ay)</label>
          <input type="number" id="calc-loan-months" placeholder="36" min="1">
        </div>
      </div>
      <button class="btn btn-primary calc-btn" onclick="handleCalcLoan()" style="width:100%;" data-i18n="calc_calculate">Hesapla</button>
      <div id="calc-loan-result"></div>
    </div>

    <!-- Gecikme CezasÄ± -->
    <div class="calc-section">
      <h3>â° <span data-i18n="calc_late_fee">Gecikme CezasÄ± Hesaplama</span></h3>
      <div class="form-group">
        <label data-i18n="pay_amount">Tutar (â‚º)</label>
        <input type="number" id="calc-late-amount" placeholder="5000" min="0">
      </div>
      <div class="form-row">
        <div class="form-group flex-1">
          <label data-i18n="calc_days_late">Geciken GÃ¼n</label>
          <input type="number" id="calc-late-days" placeholder="30" min="1">
        </div>
        <div class="form-group flex-1">
          <label data-i18n="calc_daily_rate">GÃ¼nlÃ¼k Oran (%)</label>
          <input type="number" id="calc-late-rate" placeholder="0.05" min="0" step="0.01">
        </div>
      </div>
      <button class="btn btn-primary calc-btn" onclick="handleCalcLateFee()" style="width:100%;" data-i18n="calc_calculate">Hesapla</button>
      <div id="calc-late-result"></div>
    </div>

    <!-- BorÃ§ Ã–deme PlanÄ± -->
    <div class="calc-section">
      <h3>ğŸ“Š <span data-i18n="calc_payoff">BorÃ§ Ã–deme PlanÄ±</span></h3>
      <div class="form-group">
        <label data-i18n="calc_total_debt">Toplam BorÃ§ (â‚º)</label>
        <input type="number" id="calc-payoff-debt" placeholder="50000" min="0">
      </div>
      <div class="form-row">
        <div class="form-group flex-1">
          <label data-i18n="calc_monthly_budget">AylÄ±k BÃ¼tÃ§e (â‚º)</label>
          <input type="number" id="calc-payoff-budget" placeholder="5000" min="0">
        </div>
        <div class="form-group flex-1">
          <label data-i18n="calc_rate">YÄ±llÄ±k Faiz (%)</label>
          <input type="number" id="calc-payoff-rate" placeholder="0" min="0" step="0.1">
        </div>
      </div>
      <button class="btn btn-primary calc-btn" onclick="handleCalcPayoff()" style="width:100%;" data-i18n="calc_calculate">Hesapla</button>
      <div id="calc-payoff-result"></div>
    </div>
  </div>

  <!-- ==================== SAYFA: AYARLAR ==================== -->
  <div class="page" id="page-settings">

    <!-- Genel -->
    <div class="settings-group">
      <div class="settings-item">
        <div class="set-label"><span class="set-icon">ğŸŒ</span> <span data-i18n="set_language">Dil</span></div>
        <select id="set-language" onchange="handleLanguageChange(this.value)">
          <option value="tr">TÃ¼rkÃ§e</option>
          <option value="en">English</option>
        </select>
      </div>
      <div class="settings-item">
        <div class="set-label"><span class="set-icon">ğŸ¨</span> <span data-i18n="set_theme">Tema</span></div>
        <select id="set-theme" onchange="handleThemeChange(this.value)">
          <option value="light">â˜€ï¸ AÃ§Ä±k</option>
          <option value="dark">ğŸŒ™ Koyu</option>
        </select>
      </div>
    </div>

    <!-- Premium -->
    <div class="settings-group">
      <div class="settings-item" onclick="showPremiumPrompt()">
        <div class="set-label"><span class="set-icon">â­</span> <span data-i18n="set_premium">Premium</span></div>
        <div>
          <span class="set-value" id="set-premium-status" data-i18n="set_premium_inactive">Aktif deÄŸil</span>
          <span class="premium-active-label" data-i18n="set_premium_active">Aktif âœ“</span>
        </div>
      </div>
      <div class="settings-item" onclick="restorePurchases()">
        <div class="set-label"><span class="set-icon">ğŸ”„</span> <span data-i18n="set_restore">SatÄ±n AlmalarÄ± Geri YÃ¼kle</span></div>
        <span class="set-value">â€º</span>
      </div>
    </div>

    <!-- Yedekleme -->
    <div class="settings-group">
      <div class="settings-item" onclick="backupExport()">
        <div class="set-label"><span class="set-icon">ğŸ“¤</span> <span data-i18n="set_backup_export">Yedek DÄ±ÅŸa Aktar</span></div>
        <span class="set-value">JSON â€º</span>
      </div>
      <div class="settings-item" onclick="backupImport()">
        <div class="set-label"><span class="set-icon">ğŸ“¥</span> <span data-i18n="set_backup_import">Yedek Ä°Ã§e Aktar</span></div>
        <span class="set-value">JSON â€º</span>
      </div>
    </div>

    <!-- Bildirimler -->
    <div class="settings-group">
      <div class="settings-item" onclick="rescheduleAllNotifications()">
        <div class="set-label"><span class="set-icon">ğŸ””</span> <span data-i18n="set_reminders">Bildirimleri Yenile</span></div>
        <span class="set-value">â€º</span>
      </div>
    </div>

    <!-- HakkÄ±nda -->
    <div class="settings-group">
      <div class="settings-item">
        <div class="set-label"><span class="set-icon">â„¹ï¸</span> <span data-i18n="set_about">HakkÄ±nda</span></div>
        <span class="set-value">v1.0.0</span>
      </div>
    </div>

    <p class="text-center text-muted mt-16" style="font-size:12px;">
      Ã–deme HatÄ±rlatÄ±cÄ± v1.0.0<br>
      Â© 2026 Recinilt
    </p>
  </div>

  <!-- ==================== FAB BUTON ==================== -->
  <button class="btn-fab" onclick="showAddPaymentForm()" title="Yeni Ã–deme Ekle">+</button>

  <!-- ==================== BOTTOM NAVÄ°GASYON ==================== -->
  <nav class="bottom-nav">
    <button class="nav-item active" data-page="dashboard">
      <span class="nav-icon">ğŸ </span>
      <span data-i18n="nav_home">Ana Sayfa</span>
    </button>
    <button class="nav-item" data-page="payments">
      <span class="nav-icon">ğŸ’³</span>
      <span data-i18n="nav_payments">Ã–demeler</span>
    </button>
    <button class="nav-item" data-page="calendar">
      <span class="nav-icon">ğŸ“…</span>
      <span data-i18n="nav_calendar">Takvim</span>
    </button>
    <button class="nav-item" data-page="reports">
      <span class="nav-icon">ğŸ“Š</span>
      <span data-i18n="nav_reports">Raporlar</span>
    </button>
    <button class="nav-item" data-page="settings">
      <span class="nav-icon">âš™ï¸</span>
      <span data-i18n="nav_settings">Ayarlar</span>
    </button>
  </nav>

  <!-- ==================== MODAL: Ã–DEME DETAY ==================== -->
  <div class="modal" id="modal-payment-detail"></div>

  <!-- ==================== MODAL: Ã–DEME FORMU ==================== -->
  <div class="modal" id="modal-payment-form"></div>

  <!-- ==================== MODAL: ONAY DÄ°ALOG ==================== -->
  <div class="modal" id="modal-confirm"></div>

  <!-- ==================== MODAL: PREMÄ°UM ==================== -->
  <div class="modal" id="modal-premium"></div>

  <!-- ==================== TOAST ==================== -->
  <div class="toast" id="toast"></div>

  <!-- ==================== YARDIMCI FONKSÄ°YON ==================== -->
  <script>
    // Filtre buton aktif durumu
    function activateFilter(btn) {
      const parent = btn.parentElement;
      parent.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }

    // Loading ekranÄ±nÄ± kaldÄ±r
    function hideLoading() {
      const el = document.getElementById('app-loading');
      if (el) {
        el.classList.add('hide');
        setTimeout(() => el.remove(), 500);
      }
    }

    // Uygulama hazÄ±r olduÄŸunda loading'i kaldÄ±r
    const origOnAppReady = window.onAppReady;
    const _origReady = typeof onAppReady === 'function' ? onAppReady : null;
    document.addEventListener('DOMContentLoaded', function() {
      // onAppReady tamamlandÄ±ktan sonra loading kaldÄ±rÄ±lacak
      setTimeout(hideLoading, 800);
    });
  </script>

  <!-- ==================== JS DOSYALARI ==================== -->
  <script src="cordova.js"></script>
  <script src="js/db.js"></script>
  <script src="js/templates.js"></script>
  <script src="js/i18n.js"></script>
  <script src="js/notifications.js"></script>
  <script src="js/reports.js"></script>
  <script src="js/purchase.js"></script>
  <script src="js/backup.js"></script>
  <script src="js/calculator.js"></script>
  <script src="js/app.js"></script>

</body>
</html>
