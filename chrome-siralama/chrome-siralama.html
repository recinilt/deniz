<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Chrome Yer Ä°mi SÄ±klÄ±k Analizi</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.10.3/sql-wasm.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Outfit:wght@300;400;500;600;700;800&display=swap');
  :root{--bg:#0a0a0f;--surface:#12121a;--surface2:#1a1a26;--surface3:#1e1e2e;--border:#2a2a3a;--border-active:#4a6cf7;--text:#e8e8f0;--text-dim:#8888a0;--accent:#4a6cf7;--accent-glow:rgba(74,108,247,0.25);--success:#34d399;--warn:#fbbf24;--danger:#f87171;--gold:#f59e0b}
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;-webkit-tap-highlight-color:transparent}
  body::before{content:'';position:fixed;inset:0;background:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");pointer-events:none;z-index:0}
  .container{max-width:960px;margin:0 auto;padding:40px 24px 80px;position:relative;z-index:1}
  .header{text-align:center;margin-bottom:48px}
  .header-icon{font-size:48px;margin-bottom:12px;display:block;filter:drop-shadow(0 0 24px var(--accent-glow))}
  .header h1{font-size:28px;font-weight:800;letter-spacing:-0.5px;background:linear-gradient(135deg,#fff 0%,#4a6cf7 50%,#34d399 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
  .header p{color:var(--text-dim);font-size:14px;margin-top:8px;font-weight:300}
  .header .device-badge{display:inline-block;margin-top:10px;font-size:11px;font-weight:600;padding:4px 12px;border-radius:20px;border:1px solid var(--border);color:var(--text-dim)}
  .header .device-badge.mobile{border-color:var(--warn);color:var(--warn)}
  .header .device-badge.desktop{border-color:var(--success);color:var(--success)}
  .step{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:28px;margin-bottom:20px;transition:border-color .3s,box-shadow .3s}
  .step.active{border-color:var(--border-active);box-shadow:0 0 40px var(--accent-glow),inset 0 1px 0 rgba(74,108,247,0.1)}
  .step.done{border-color:var(--success);box-shadow:0 0 20px rgba(52,211,153,0.1)}
  .step.locked{opacity:.45;pointer-events:none;filter:grayscale(.3)}
  .step-badge{display:inline-flex;align-items:center;gap:8px;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;color:var(--accent);margin-bottom:14px}
  .step.done .step-badge{color:var(--success)}
  .step-badge .num{width:24px;height:24px;border-radius:50%;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:800}
  .step.done .step-badge .num{background:var(--success)}
  .step h2{font-size:18px;font-weight:700;margin-bottom:6px}
  .step .desc{font-size:13px;color:var(--text-dim);margin-bottom:18px;line-height:1.6}
  .info-box{background:rgba(251,191,36,0.06);border:1px solid rgba(251,191,36,0.2);border-radius:10px;padding:14px 16px;margin-bottom:16px;font-size:12.5px;line-height:1.7;color:#e8d5a0}
  .info-box strong{color:var(--warn);font-weight:600}
  .info-box code{font-family:'JetBrains Mono',monospace;font-size:11px;background:rgba(255,255,255,0.06);padding:2px 6px;border-radius:4px;color:#fbbf24}
  .info-box .steps-list{margin-top:8px;padding-left:0;list-style:none;counter-reset:infoStep}
  .info-box .steps-list li{counter-increment:infoStep;margin-bottom:4px}
  .info-box .steps-list li::before{content:counter(infoStep) ".";font-weight:700;color:var(--warn);margin-right:6px}
  .mobile-panel{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:28px;margin-bottom:20px;text-align:center}
  .mobile-panel .icon{font-size:56px;margin-bottom:16px;display:block}
  .mobile-panel h2{font-size:18px;font-weight:700;margin-bottom:10px}
  .mobile-panel p{font-size:13px;color:var(--text-dim);line-height:1.7;margin-bottom:16px}
  .mobile-panel .divider{height:1px;background:var(--border);margin:20px 0}
  .mobile-panel .section-title{font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--accent);margin-bottom:12px}
  .path-row{display:flex;align-items:center;gap:8px;margin-bottom:14px}
  .path-display{flex:1;font-family:'JetBrains Mono',monospace;font-size:12px;background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:10px 14px;color:var(--accent);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;user-select:all}
  .copy-btn,.action-btn,.analyze-btn,.tab-btn,.filter-btn,.file-btn,.mobile-btn{min-height:44px;font-family:'Outfit',sans-serif;cursor:pointer;transition:all .2s;-webkit-tap-highlight-color:transparent}
  .copy-btn{flex-shrink:0;background:var(--accent);color:#fff;border:none;border-radius:8px;padding:10px 16px;font-size:12px;font-weight:600;display:flex;align-items:center;gap:6px;white-space:nowrap}
  .copy-btn:hover{filter:brightness(1.15);transform:translateY(-1px)}
  .copy-btn.copied{background:var(--success)}
  .mobile-btn{display:flex;align-items:center;justify-content:center;gap:8px;width:100%;padding:14px 20px;border-radius:12px;font-size:14px;font-weight:600;border:2px dashed var(--border);background:var(--surface2);color:var(--text);margin-bottom:10px}
  .mobile-btn:hover{border-color:var(--accent);background:rgba(74,108,247,0.04)}
  .mobile-btn.primary{border-style:solid;border-color:var(--accent);background:rgba(74,108,247,0.08);color:var(--accent)}
  .mobile-btn .btn-icon{font-size:20px}
  .profile-select{width:100%;font-family:'Outfit',sans-serif;font-size:14px;background:var(--bg);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:12px 14px;min-height:44px;appearance:none;cursor:pointer;margin-bottom:14px;background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%238888a0' stroke-width='1.5' fill='none'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 14px center}
  .profile-select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-glow)}
  .file-buttons{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .file-btn{width:100%;background:var(--surface2);border:2px dashed var(--border);border-radius:12px;padding:20px 16px;text-align:center;display:flex;flex-direction:column;align-items:center;gap:8px}
  .file-btn:hover{border-color:var(--accent);background:rgba(74,108,247,0.04);transform:translateY(-2px)}
  .file-btn.loaded{border-style:solid;border-color:var(--success);background:rgba(52,211,153,0.04)}
  .file-btn .icon{font-size:28px}.file-btn .label{font-size:13px;font-weight:600}.file-btn .sublabel{font-size:11px;color:var(--text-dim)}
  .analyze-btn{width:100%;padding:16px;border:none;border-radius:12px;font-size:16px;font-weight:700;margin-top:16px;background:linear-gradient(135deg,var(--accent),#34d399);color:#fff;letter-spacing:.5px}
  .analyze-btn:hover{filter:brightness(1.1);transform:translateY(-1px);box-shadow:0 8px 30px var(--accent-glow)}
  .analyze-btn:disabled{opacity:.35;cursor:not-allowed;filter:none;transform:none;box-shadow:none}
  #results{margin-top:24px}
  .results-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:12px}
  .results-header h2{font-size:20px;font-weight:700}
  .results-stats{display:flex;gap:16px;font-size:12px;color:var(--text-dim);flex-wrap:wrap}
  .results-stats span{display:flex;align-items:center;gap:4px}
  .results-stats .val{color:var(--text);font-weight:700;font-size:14px}
  .action-row{display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap}
  .action-btn{font-size:13px;font-weight:600;border:none;border-radius:8px;padding:10px 20px;display:flex;align-items:center;gap:6px}
  .action-btn:hover{filter:brightness(1.1);transform:translateY(-1px)}
  .action-btn.save-btn{background:var(--accent);color:#fff}
  .action-btn.save-btn.saved{background:var(--success)}
  .action-btn.refresh-btn{background:var(--surface2);color:var(--text);border:1px solid var(--border)}
  .action-btn.refresh-btn:hover{border-color:var(--warn);color:var(--warn)}
  .action-btn.delete-btn{background:var(--surface2);color:var(--danger);border:1px solid rgba(248,113,113,0.3)}
  .action-btn.delete-btn:hover{background:rgba(248,113,113,0.08);border-color:var(--danger)}
  .action-btn.json-btn{background:var(--surface2);color:var(--success);border:1px solid rgba(52,211,153,0.3)}
  .action-btn.json-btn:hover{border-color:var(--success);background:rgba(52,211,153,0.08)}
  .saved-info{font-size:11px;color:var(--text-dim);margin-bottom:16px;display:flex;align-items:center;gap:6px}
  .saved-info .date{color:var(--warn);font-weight:600;font-family:'JetBrains Mono',monospace}
  .filter-row{display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap}
  .search-input{flex:1;min-width:200px;font-family:'Outfit',sans-serif;font-size:13px;background:var(--surface);border:1px solid var(--border);color:var(--text);border-radius:8px;padding:10px 14px;min-height:44px}
  .search-input:focus{outline:none;border-color:var(--accent)}
  .tab-row{display:flex;gap:0;margin-bottom:16px;border:1px solid var(--border);border-radius:10px;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;scrollbar-width:none;flex-wrap:nowrap}
  .tab-row::-webkit-scrollbar{display:none}
  .tab-btn{font-size:12px;font-weight:600;background:var(--surface);border:none;color:var(--text-dim);padding:12px 16px;flex-shrink:0;text-align:center;border-right:1px solid var(--border);white-space:nowrap}
  .tab-btn:last-child{border-right:none}
  .tab-btn:hover{background:var(--surface2);color:var(--text)}
  .tab-btn.active{background:var(--accent);color:#fff}
  .tab-btn.active.tab-fav{background:var(--gold);color:#000}
  .tab-btn.active.tab-imp{background:#e879f9;color:#000}
  .tab-btn .tab-count{font-size:10px;opacity:.7;margin-left:4px}
  .domain-list{display:flex;flex-direction:column;gap:6px}
  .domain-group{border:1px solid var(--border);border-radius:12px;overflow:hidden;transition:border-color .2s}
  .domain-group.open{border-color:var(--accent)}
  .domain-header{display:grid;grid-template-columns:44px 1fr auto auto;gap:12px;align-items:center;background:var(--surface);padding:14px 16px;cursor:pointer;transition:background .2s;user-select:none;min-height:56px}
  .domain-header:hover{background:var(--surface2)}
  .domain-group.open .domain-header{background:var(--surface2);border-bottom:1px solid var(--border)}
  .domain-rank{font-family:'JetBrains Mono',monospace;font-size:16px;font-weight:800;text-align:center;color:var(--text-dim)}
  .domain-group:nth-child(1) .domain-rank{color:#fbbf24;font-size:20px}
  .domain-group:nth-child(2) .domain-rank{color:#cbd5e1;font-size:18px}
  .domain-group:nth-child(3) .domain-rank{color:#d97706;font-size:18px}
  .domain-info{overflow:hidden}
  .domain-name{font-size:14px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .domain-meta{font-size:11px;color:var(--text-dim);margin-top:2px}
  .domain-meta .bm-count-label{color:var(--accent);font-weight:600}
  .domain-visits{font-family:'JetBrains Mono',monospace;font-size:14px;font-weight:700;color:var(--success);background:rgba(52,211,153,0.08);padding:6px 12px;border-radius:8px;white-space:nowrap}
  .domain-visits.zero{color:var(--text-dim);background:rgba(136,136,160,0.06)}
  .domain-chevron{font-size:14px;color:var(--text-dim);transition:transform .25s;width:20px;text-align:center}
  .domain-group.open .domain-chevron{transform:rotate(90deg);color:var(--accent)}
  .domain-body{display:none;background:var(--bg)}
  .domain-group.open .domain-body{display:block}
  .path-item{display:grid;grid-template-columns:auto 1fr auto;gap:8px;align-items:center;padding:12px 16px 12px 64px;border-bottom:1px solid rgba(42,42,58,0.5);transition:background .15s;min-height:52px}
  .path-item:last-child{border-bottom:none}
  .path-item:hover{background:rgba(74,108,247,0.04)}
  .path-marks{display:flex;gap:4px;flex-shrink:0}
  .mark-btn{width:36px;height:36px;border:1px solid var(--border);border-radius:8px;background:transparent;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;transition:all .15s;padding:0;line-height:1;opacity:.4;-webkit-tap-highlight-color:transparent}
  .mark-btn:hover{opacity:.8;background:var(--surface2)}
  .mark-btn.active{opacity:1;border-color:transparent}
  .mark-btn.fav-btn.active{background:rgba(245,158,11,0.15);border-color:var(--gold)}
  .mark-btn.imp-btn.active{background:rgba(232,121,249,0.15);border-color:#e879f9}
  .path-link{overflow:hidden;text-decoration:none;color:inherit;display:block;padding:4px 0}
  .path-title{font-size:12.5px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:2px}
  .path-url{font-size:10.5px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .path-folders{display:flex;flex-wrap:wrap;gap:4px;margin-top:3px}
  .path-folder-tag{font-size:9.5px;color:var(--accent);background:rgba(74,108,247,0.08);padding:2px 7px;border-radius:4px;white-space:nowrap;max-width:220px;overflow:hidden;text-overflow:ellipsis}
  .path-visits{font-family:'JetBrains Mono',monospace;font-size:12px;font-weight:600;color:var(--success);white-space:nowrap;flex-shrink:0}
  .path-visits.zero{color:var(--text-dim)}
  .remove-btn{width:36px;height:36px;border:1px solid rgba(248,113,113,0.3);border-radius:8px;background:transparent;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center;transition:all .15s;color:var(--danger);flex-shrink:0;padding:0}
  .remove-btn:hover{background:rgba(248,113,113,0.1);border-color:var(--danger)}
  .flat-list{display:flex;flex-direction:column;gap:4px}
  .flat-item{display:grid;grid-template-columns:1fr auto auto;gap:10px;align-items:center;background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:12px 16px;min-height:56px;transition:all .2s}
  .flat-item:hover{border-color:var(--accent);background:var(--surface2)}
  .flat-info{overflow:hidden;text-decoration:none;color:inherit;display:block}
  .flat-title{font-size:13px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:2px}
  .flat-url{font-size:11px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .flat-domain{font-size:10px;color:var(--accent);margin-top:2px}
  .no-match{text-align:center;padding:40px;color:var(--text-dim);font-size:14px}
  .loading-overlay{display:none;position:fixed;inset:0;background:rgba(10,10,15,0.85);z-index:999;justify-content:center;align-items:center;flex-direction:column;gap:16px}
  .loading-overlay.show{display:flex}
  .spinner{width:40px;height:40px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin .7s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
  .loading-text{font-size:14px;color:var(--text-dim)}
  .hidden{display:none !important}
  @media(max-width:768px){
    .container{padding:20px 14px 60px}
    .header{margin-bottom:28px}
    .header h1{font-size:22px}
    .header-icon{font-size:40px}
    .step{padding:20px 16px}
    .file-buttons{grid-template-columns:1fr}
    .domain-header{grid-template-columns:36px 1fr auto;gap:8px;padding:12px 12px}
    .domain-chevron{display:none}
    .domain-visits{font-size:12px;padding:4px 8px}
    .domain-name{font-size:13px}
    .path-item{padding:10px 12px 10px 48px;gap:6px}
    .mark-btn{width:32px;height:32px;font-size:14px}
    .action-row{flex-direction:column}
    .action-btn{justify-content:center;width:100%}
    .results-stats{flex-direction:column;gap:4px}
    .filter-row{flex-direction:column}
    .search-input{min-width:unset}
    .flat-item{padding:10px 12px}
    .tab-btn{padding:10px 14px;font-size:11px}
  }
  .fade-in{animation:fadeIn .4s ease both}
  @keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>
<div class="loading-overlay" id="loadingOverlay"><div class="spinner"></div><div class="loading-text" id="loadingText">Analiz ediliyor...</div></div>
<div class="container">
  <div class="header fade-in">
    <span class="header-icon">ğŸ”–</span>
    <h1>Chrome Yer Ä°mi SÄ±klÄ±k Analizi</h1>
    <p>Yer imlerinizi domain bazlÄ± grupla, ziyaret sÄ±klÄ±ÄŸÄ±na gÃ¶re sÄ±rala</p>
    <span class="device-badge" id="deviceBadge"></span>
  </div>
  <div id="mobilePanel" class="hidden">
    <div class="mobile-panel fade-in">
      <span class="icon">ğŸ“±</span>
      <h2>Mobil Cihaz AlgÄ±landÄ±</h2>
      <p>Chrome yer imi ve geÃ§miÅŸ dosyalarÄ±na mobilde doÄŸrudan eriÅŸilemez. AÅŸaÄŸÄ±daki yÃ¶ntemlerden birini kullanabilirsiniz:</p>
      <div class="info-box" style="text-align:left">
        <strong>YÃ¶ntem 1 â€” Bilgisayardan Aktarma (Ã¶nerilen)</strong>
        <ol class="steps-list">
          <li>Bu aracÄ± <strong>bilgisayarÄ±nÄ±zda</strong> aÃ§Ä±n ve analizi yapÄ±n</li>
          <li>SonuÃ§ ekranÄ±nda <strong>ğŸ“¥ JSON Ä°ndir</strong> butonuna tÄ±klayÄ±n</li>
          <li>Ä°ndirdiÄŸiniz dosyayÄ± telefonunuza gÃ¶nderin (WhatsApp, Drive, e-posta vb.)</li>
          <li>Bu sayfada <strong>ğŸ“¤ JSON YÃ¼kle</strong> butonuna tÄ±klayÄ±n</li>
        </ol>
      </div>
      <button class="mobile-btn primary" onclick="document.getElementById('jsonImportInput').click()">
        <span class="btn-icon">ğŸ“¤</span> JSON DosyasÄ± YÃ¼kle
      </button>
      <input type="file" id="jsonImportInput" accept=".json,application/json" style="display:none" onchange="importJSON(this)">
      <div class="divider"></div>
      <div class="section-title">YÃ¶ntem 2 â€” Bookmarks HTML Ä°Ã§e Aktarma</div>
      <p style="font-size:12px;color:var(--text-dim);margin-bottom:12px">Chrome masaÃ¼stÃ¼nde <strong>Yer Ä°mi YÃ¶neticisi â†’ DÄ±ÅŸa Aktar</strong> ile HTML dosyasÄ± alabilirsiniz. Bu dosya ziyaret sayÄ±sÄ± iÃ§ermez, sadece yer imlerini listeler.</p>
      <button class="mobile-btn" onclick="document.getElementById('htmlImportInput').click()">
        <span class="btn-icon">ğŸ“‚</span> Bookmarks HTML YÃ¼kle
      </button>
      <input type="file" id="htmlImportInput" accept=".html,.htm" style="display:none" onchange="importBookmarksHTML(this)">
    </div>
  </div>
  <div id="stepsWrapper">
    <div class="step active fade-in" id="step1">
      <div class="step-badge"><span class="num">1</span> PROFÄ°L ALGILAMA</div>
      <h2>Local State DosyasÄ±nÄ± SeÃ§in</h2>
      <p class="desc">Bu dosya tÃ¼m Chrome profillerinizin listesini iÃ§erir.</p>
      <div class="info-box"><span class="emoji">âš ï¸</span> <strong>Dosya SeÃ§ici AÃ§Ä±ldÄ±ÄŸÄ±nda:</strong><ol class="steps-list"><li>AÅŸaÄŸÄ±daki yolu <strong>ğŸ“‹ Kopyala</strong> butonuyla kopyalayÄ±n</li><li>Dosya seÃ§icinin <strong>adres Ã§ubuÄŸuna</strong> tÄ±klayÄ±n (<code>Alt+D</code>)</li><li>YapÄ±ÅŸtÄ±rÄ±n (<code>Ctrl+V</code>) ve <strong>Enter</strong>'a basÄ±n</li><li><code>Local State</code> dosyasÄ±nÄ± seÃ§in</li></ol></div>
      <div class="path-row"><div class="path-display" id="localStatePath">%LOCALAPPDATA%\Google\Chrome\User Data</div><button class="copy-btn" onclick="copyPath('localStatePath', this)">ğŸ“‹ Kopyala</button></div>
      <div class="file-btn-wrap"><div class="file-btn" id="localStateBtn" onclick="document.getElementById('localStateInput').click()"><span class="icon">ğŸ“‚</span><span class="label">Local State DosyasÄ±nÄ± SeÃ§</span><span class="sublabel">User Data klasÃ¶rÃ¼ndeki "Local State" dosyasÄ±</span></div><input type="file" id="localStateInput" accept="*" style="display:none" onchange="handleLocalState(this)"></div>
    </div>
    <div class="step locked" id="step2">
      <div class="step-badge"><span class="num">2</span> PROFÄ°L SEÃ‡Ä°MÄ°</div>
      <h2>Chrome Profilinizi SeÃ§in</h2>
      <p class="desc">AlgÄ±lanan profillerden aktif kullandÄ±ÄŸÄ±nÄ±zÄ± seÃ§in.</p>
      <select class="profile-select" id="profileSelect" onchange="onProfileChange()"><option disabled selected>â€” Profil seÃ§in â€”</option></select>
      <div id="profilePathSection" style="display:none"><div class="info-box"><span class="emoji">ğŸ“</span> Dosya seÃ§ici aÃ§Ä±ldÄ±ÄŸÄ±nda bu yolu adres Ã§ubuÄŸuna yapÄ±ÅŸtÄ±rÄ±n.</div><div class="path-row"><div class="path-display" id="profilePath"></div><button class="copy-btn" onclick="copyPath('profilePath', this)">ğŸ“‹ Kopyala</button></div></div>
    </div>
    <div class="step locked" id="step3">
      <div class="step-badge"><span class="num">3</span> DOSYA SEÃ‡Ä°MÄ° & ANALÄ°Z</div>
      <h2>Bookmarks ve History DosyalarÄ±nÄ± SeÃ§in</h2>
      <p class="desc">Her iki dosya da seÃ§ilen profil klasÃ¶rÃ¼ndedir.</p>
      <div class="info-box"><span class="emoji">ğŸ’¡</span> Chrome aÃ§Ä±kken okunabilir. Son birkaÃ§ dakikalÄ±k ziyaretler eksik kalabilir â€” normal.</div>
      <div class="file-buttons"><div class="file-btn-wrap"><div class="file-btn" id="bookmarksBtn" onclick="document.getElementById('bookmarksInput').click()"><span class="icon">ğŸ”–</span><span class="label">Bookmarks</span><span class="sublabel">Yer imleri (JSON)</span></div><input type="file" id="bookmarksInput" accept="*" style="display:none" onchange="handleBookmarks(this)"></div><div class="file-btn-wrap"><div class="file-btn" id="historyBtn" onclick="document.getElementById('historyInput').click()"><span class="icon">ğŸ“Š</span><span class="label">History</span><span class="sublabel">GeÃ§miÅŸ (SQLite)</span></div><input type="file" id="historyInput" accept="*" style="display:none" onchange="handleHistory(this)"></div></div>
      <button class="analyze-btn" id="analyzeBtn" disabled onclick="analyze()">ğŸ” Analiz Et â€” Domain BazlÄ± SÄ±rala</button>
    </div>
  </div>
  <div id="results"></div>
</div>
<script>
var STORAGE_KEY='chrome_bm_analyzer_data',FAV_KEY='chrome_bm_favorites',IMP_KEY='chrome_bm_important';
var profilesData={},selectedProfileDir='',bookmarksJSON=null,historyBuffer=null,domainGroups=[],savedDate=null,favorites={},important={},currentTab='all',IS_MOBILE=false;

function detectDevice(){var ua=navigator.userAgent||'';var isMobileUA=/Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ua);var isTouch='ontouchstart' in window||(navigator.maxTouchPoints&&navigator.maxTouchPoints>0);var isSmall=window.innerWidth<768;IS_MOBILE=isMobileUA||(isTouch&&isSmall);var badge=document.getElementById('deviceBadge');if(badge){if(IS_MOBILE){badge.textContent='ğŸ“± Mobil Cihaz';badge.className='device-badge mobile'}else{badge.textContent='ğŸ–¥ï¸ MasaÃ¼stÃ¼';badge.className='device-badge desktop'}}return IS_MOBILE}

document.addEventListener('DOMContentLoaded',function(){var mobile=detectDevice();loadMarks();var hasLocal=false;try{var raw=localStorage.getItem(STORAGE_KEY);if(raw){var saved=JSON.parse(raw);if(saved&&Array.isArray(saved.domainGroups)&&saved.domainGroups.length>0){domainGroups=saved.domainGroups;savedDate=saved.savedDate||null;hasLocal=true}}}catch(e){console.warn('localStorage:',e);try{localStorage.removeItem(STORAGE_KEY)}catch(_){}}
if(hasLocal){document.getElementById('stepsWrapper').classList.add('hidden');document.getElementById('mobilePanel').classList.add('hidden');requestAnimationFrame(function(){renderResults()})}else if(mobile){document.getElementById('stepsWrapper').classList.add('hidden');document.getElementById('mobilePanel').classList.remove('hidden')}else{document.getElementById('mobilePanel').classList.add('hidden')}});

function loadMarks(){try{var f=localStorage.getItem(FAV_KEY);favorites=f?JSON.parse(f):{}}catch(e){favorites={}}try{var im=localStorage.getItem(IMP_KEY);important=im?JSON.parse(im):{}}catch(e){important={}}}
function saveMarks(){try{localStorage.setItem(FAV_KEY,JSON.stringify(favorites))}catch(e){}try{localStorage.setItem(IMP_KEY,JSON.stringify(important))}catch(e){}}
function toggleFav(url,event){event.preventDefault();event.stopPropagation();if(favorites[url])delete favorites[url];else favorites[url]=true;saveMarks();updateMarkButtons(url);updateTabCounts()}
function toggleImp(url,event){event.preventDefault();event.stopPropagation();if(important[url])delete important[url];else important[url]=true;saveMarks();updateMarkButtons(url);updateTabCounts()}
function removeFav(url,event){event.preventDefault();event.stopPropagation();delete favorites[url];saveMarks();if(currentTab==='favorites')renderTabContent();updateTabCounts()}
function removeImp(url,event){event.preventDefault();event.stopPropagation();delete important[url];saveMarks();if(currentTab==='important')renderTabContent();updateTabCounts()}
function updateMarkButtons(url){var favBtns=document.querySelectorAll('.fav-btn[data-url="'+escapeAttr(url)+'"]');for(var i=0;i<favBtns.length;i++){if(favorites[url]){favBtns[i].classList.add('active');favBtns[i].textContent='â­'}else{favBtns[i].classList.remove('active');favBtns[i].textContent='â˜†'}}var impBtns=document.querySelectorAll('.imp-btn[data-url="'+escapeAttr(url)+'"]');for(var i=0;i<impBtns.length;i++){if(important[url]){impBtns[i].classList.add('active');impBtns[i].textContent='ğŸ“Œ'}else{impBtns[i].classList.remove('active');impBtns[i].textContent='ğŸ“'}}}
function updateTabCounts(){var fc=document.getElementById('favCount');var ic=document.getElementById('impCount');if(fc)fc.textContent='('+Object.keys(favorites).length+')';if(ic)ic.textContent='('+Object.keys(important).length+')'}

async function copyPath(elementId,btn){var text=document.getElementById(elementId).textContent;try{await navigator.clipboard.writeText(text)}catch(e){var ta=document.createElement('textarea');ta.value=text;ta.style.cssText='position:fixed;left:-9999px';document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta)}btn.classList.add('copied');btn.innerHTML='âœ… KopyalandÄ±!';setTimeout(function(){btn.classList.remove('copied');btn.innerHTML='ğŸ“‹ Kopyala'},2000)}

function exportJSON(){var data={domainGroups:domainGroups,favorites:favorites,important:important,exportDate:new Date().toISOString(),version:2};var blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});var url=URL.createObjectURL(blob);var a=document.createElement('a');a.href=url;a.download='chrome-bookmarks-analiz-'+new Date().toISOString().slice(0,10)+'.json';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);var btn=document.getElementById('jsonExportBtn');if(btn){var orig=btn.innerHTML;btn.innerHTML='âœ… Ä°ndirildi!';setTimeout(function(){btn.innerHTML=orig},2000)}}

function importJSON(input){var file=input.files[0];if(!file)return;var reader=new FileReader();reader.onload=function(e){try{var data=JSON.parse(e.target.result);if(!data.domainGroups||!Array.isArray(data.domainGroups)||data.domainGroups.length===0){alert('GeÃ§erli analiz verisi bulunamadÄ±.');return}domainGroups=data.domainGroups;savedDate=data.exportDate||new Date().toISOString();if(data.favorites){favorites=data.favorites;try{localStorage.setItem(FAV_KEY,JSON.stringify(favorites))}catch(x){}}if(data.important){important=data.important;try{localStorage.setItem(IMP_KEY,JSON.stringify(important))}catch(x){}}try{localStorage.setItem(STORAGE_KEY,JSON.stringify({domainGroups:domainGroups,savedDate:savedDate}))}catch(x){}document.getElementById('mobilePanel').classList.add('hidden');document.getElementById('stepsWrapper').classList.add('hidden');renderResults()}catch(err){alert('JSON okunamadÄ±: '+err.message)}};reader.readAsText(file,'utf-8');input.value=''}

function importBookmarksHTML(input){var file=input.files[0];if(!file)return;var reader=new FileReader();reader.onload=function(e){try{var html=e.target.result;var parser=new DOMParser();var doc=parser.parseFromString(html,'text/html');var links=doc.querySelectorAll('a[href]');if(links.length===0){alert('Yer imi bulunamadÄ±.');return}var urlMap={};for(var i=0;i<links.length;i++){var a=links[i];var href=a.getAttribute('href');if(!href||!href.startsWith('http'))continue;var folder='';var parent=a.closest('dl');if(parent){var prev=parent.previousElementSibling;if(prev&&prev.tagName==='H3')folder=prev.textContent.trim()}if(!urlMap[href])urlMap[href]={title:a.textContent.trim()||'(Ä°simsiz)',url:href,folders:[],visitCount:0};if(folder&&urlMap[href].folders.indexOf(folder)===-1)urlMap[href].folders.push(folder)}var dMap={};Object.keys(urlMap).forEach(function(key){var item=urlMap[key];var d=getDomain(item.url);if(!d)return;if(!dMap[d])dMap[d]=[];dMap[d].push(item)});domainGroups=Object.keys(dMap).map(function(domain){var paths=dMap[domain];paths.sort(function(a,b){return b.visitCount-a.visitCount});return{domain:domain,totalVisits:0,uniqueUrls:paths.length,paths:paths}});domainGroups.sort(function(a,b){return b.uniqueUrls-a.uniqueUrls});savedDate=new Date().toISOString();try{localStorage.setItem(STORAGE_KEY,JSON.stringify({domainGroups:domainGroups,savedDate:savedDate}))}catch(x){}document.getElementById('mobilePanel').classList.add('hidden');document.getElementById('stepsWrapper').classList.add('hidden');renderResults()}catch(err){alert('HTML okunamadÄ±: '+err.message)}};reader.readAsText(file,'utf-8');input.value=''}

function saveToLocal(){try{var data={domainGroups:domainGroups,savedDate:new Date().toISOString()};localStorage.setItem(STORAGE_KEY,JSON.stringify(data));savedDate=data.savedDate;var btn=document.getElementById('saveBtn');if(btn){btn.classList.add('saved');btn.innerHTML='âœ… Kaydedildi!';setTimeout(function(){btn.classList.remove('saved');btn.innerHTML='ğŸ’¾ Lokale Kaydet'},2000)}updateSavedInfo()}catch(e){alert(e.name==='QuotaExceededError'?'localStorage doldu.':'Kaydetme hatasÄ±: '+e.message)}}
function deleteFromLocal(){try{localStorage.removeItem(STORAGE_KEY)}catch(e){}savedDate=null}
function updateSavedInfo(){var el=document.getElementById('savedInfo');if(!el)return;if(savedDate){var d=new Date(savedDate);var str=d.toLocaleDateString('tr-TR',{day:'2-digit',month:'2-digit',year:'numeric',hour:'2-digit',minute:'2-digit'});el.innerHTML='ğŸ“Œ Lokal kayÄ±t: <span class="date">'+str+'</span>';el.classList.remove('hidden')}else{el.classList.add('hidden')}}
function refreshAnalysis(){deleteFromLocal();domainGroups=[];bookmarksJSON=null;historyBuffer=null;document.getElementById('results').innerHTML='';if(IS_MOBILE){document.getElementById('stepsWrapper').classList.add('hidden');document.getElementById('mobilePanel').classList.remove('hidden')}else{document.getElementById('mobilePanel').classList.add('hidden');document.getElementById('stepsWrapper').classList.remove('hidden');document.getElementById('step1').className='step active fade-in';document.getElementById('step2').className='step locked';document.getElementById('step3').className='step locked';document.getElementById('profilePathSection').style.display='none';document.getElementById('profileSelect').innerHTML='<option disabled selected>â€” Profil seÃ§in â€”</option>';document.getElementById('localStateBtn').classList.remove('loaded');document.getElementById('localStateBtn').querySelector('.label').textContent='Local State DosyasÄ±nÄ± SeÃ§';document.getElementById('bookmarksBtn').classList.remove('loaded');document.getElementById('bookmarksBtn').querySelector('.label').textContent='Bookmarks';document.getElementById('historyBtn').classList.remove('loaded');document.getElementById('historyBtn').querySelector('.label').textContent='History';document.getElementById('analyzeBtn').disabled=true;document.getElementById('localStateInput').value='';document.getElementById('bookmarksInput').value='';document.getElementById('historyInput').value=''}}

function handleLocalState(input){var file=input.files[0];if(!file)return;var reader=new FileReader();reader.onload=function(e){try{var data=JSON.parse(e.target.result);var cache=data&&data.profile?data.profile.info_cache:null;if(!cache||Object.keys(cache).length===0){alert('Profil bilgisi bulunamadÄ±.');return}profilesData=cache;var select=document.getElementById('profileSelect');select.innerHTML='<option disabled selected>â€” Profil seÃ§in â€”</option>';Object.keys(cache).forEach(function(dir){var info=cache[dir];var name=info.name||info.gaia_name||dir;var email=info.user_name||info.gaia_name||'';var label=email?name+' ('+email+') â€” ['+dir+']':name+' â€” ['+dir+']';var opt=document.createElement('option');opt.value=dir;opt.textContent=label;select.appendChild(opt)});if(Object.keys(cache).length===1){select.selectedIndex=1;onProfileChange()}document.getElementById('localStateBtn').classList.add('loaded');document.getElementById('localStateBtn').querySelector('.label').textContent='âœ… Local State YÃ¼klendi';document.getElementById('step1').className='step done fade-in';document.getElementById('step2').className='step active'}catch(err){alert('Dosya okunamadÄ±: '+err.message)}};reader.readAsText(file,'utf-8')}
function onProfileChange(){var dir=document.getElementById('profileSelect').value;if(!dir)return;selectedProfileDir=dir;document.getElementById('profilePath').textContent='%LOCALAPPDATA%\\Google\\Chrome\\User Data\\'+dir;document.getElementById('profilePathSection').style.display='block';document.getElementById('step2').className='step done';document.getElementById('step3').className='step active';bookmarksJSON=null;historyBuffer=null;document.getElementById('bookmarksBtn').classList.remove('loaded');document.getElementById('bookmarksBtn').querySelector('.label').textContent='Bookmarks';document.getElementById('historyBtn').classList.remove('loaded');document.getElementById('historyBtn').querySelector('.label').textContent='History';document.getElementById('analyzeBtn').disabled=true;document.getElementById('results').innerHTML=''}
function handleBookmarks(input){var file=input.files[0];if(!file)return;var reader=new FileReader();reader.onload=function(e){try{bookmarksJSON=JSON.parse(e.target.result);if(!bookmarksJSON.roots){alert('GeÃ§erli Bookmarks deÄŸil.');bookmarksJSON=null;return}document.getElementById('bookmarksBtn').classList.add('loaded');document.getElementById('bookmarksBtn').querySelector('.label').textContent='âœ… Bookmarks YÃ¼klendi';checkReady()}catch(err){alert('OkunamadÄ±: '+err.message)}};reader.readAsText(file,'utf-8')}
function handleHistory(input){var file=input.files[0];if(!file)return;var reader=new FileReader();reader.onload=function(e){historyBuffer=new Uint8Array(e.target.result);if(!String.fromCharCode.apply(null,historyBuffer.slice(0,15)).startsWith('SQLite format')){alert('GeÃ§erli History deÄŸil.');historyBuffer=null;return}document.getElementById('historyBtn').classList.add('loaded');document.getElementById('historyBtn').querySelector('.label').textContent='âœ… History YÃ¼klendi';checkReady()};reader.readAsArrayBuffer(file)}
function checkReady(){document.getElementById('analyzeBtn').disabled=!(bookmarksJSON&&historyBuffer)}

function getDomain(url){try{return new URL(url).hostname.replace(/^www\./,'')}catch(e){return null}}
function getPathDisplay(url){try{var u=new URL(url);var p=u.pathname+u.search+u.hash;return p==='/'?'/':p}catch(e){return url}}
function extractBookmarksRaw(node,folder){var items=[];if(node.type==='url')items.push({title:node.name||'(Ä°simsiz)',url:node.url,folder:folder});if(node.children){var cur=folder?folder+' â€º '+(node.name||''):(node.name||'');node.children.forEach(function(child){items.push.apply(items,extractBookmarksRaw(child,cur))})}return items}
function escapeHtml(s){if(!s)return'';return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;')}
function escapeAttr(s){if(!s)return'';return s.replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/'/g,'&#39;')}

async function analyze(){var overlay=document.getElementById('loadingOverlay');var lt=document.getElementById('loadingText');overlay.classList.add('show');try{lt.textContent='sql.js yÃ¼kleniyor...';var SQL=await initSqlJs({locateFile:function(f){return'https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.10.3/'+f}});lt.textContent='History okunuyor...';var db=new SQL.Database(historyBuffer);lt.textContent='Ziyaret sayÄ±larÄ± Ã§Ä±karÄ±lÄ±yor...';var visitMap={};try{var stmt=db.exec("SELECT url, visit_count, title FROM urls");if(stmt.length>0)stmt[0].values.forEach(function(r){visitMap[r[0]]={count:r[1]||0,title:r[2]||''}})}catch(e){console.warn('SQL:',e)}db.close();lt.textContent='Yer imleri iÅŸleniyor...';var rawBm=[];Object.values(bookmarksJSON.roots).forEach(function(root){if(root&&typeof root==='object')rawBm.push.apply(rawBm,extractBookmarksRaw(root,''))});lt.textContent='URL deduplication...';var urlMap={};rawBm.forEach(function(bm){if(!bm.url||!bm.url.startsWith('http'))return;if(!urlMap[bm.url]){var v=visitMap[bm.url];urlMap[bm.url]={title:bm.title,url:bm.url,folders:[],visitCount:v?v.count:0}}if(bm.folder&&urlMap[bm.url].folders.indexOf(bm.folder)===-1)urlMap[bm.url].folders.push(bm.folder)});lt.textContent='Domain gruplama...';var dMap={};Object.keys(urlMap).forEach(function(key){var item=urlMap[key];var d=getDomain(item.url);if(!d)return;if(!dMap[d])dMap[d]=[];dMap[d].push({url:item.url,title:item.title,visitCount:item.visitCount,folders:item.folders})});domainGroups=Object.keys(dMap).map(function(domain){var paths=dMap[domain];paths.sort(function(a,b){return b.visitCount-a.visitCount});var total=0;paths.forEach(function(p){total+=p.visitCount});return{domain:domain,totalVisits:total,uniqueUrls:paths.length,paths:paths}});domainGroups.sort(function(a,b){return b.totalVisits-a.totalVisits});savedDate=null;overlay.classList.remove('show');document.getElementById('stepsWrapper').classList.add('hidden');renderResults()}catch(err){overlay.classList.remove('show');alert('Hata: '+err.message);console.error(err)}}

function renderResults(){var c=document.getElementById('results');if(!c)return;var td=domainGroups.length,tu=0,tv=0;for(var i=0;i<domainGroups.length;i++){tu+=domainGroups[i].uniqueUrls;tv+=domainGroups[i].totalVisits}var favCount=Object.keys(favorites).length;var impCount=Object.keys(important).length;var hasDelete=savedDate?'<button class="action-btn delete-btn" onclick="deleteSavedAndReset()">ğŸ—‘ï¸ Lokal KaydÄ± Sil</button>':'';
c.innerHTML='<div class="results-header fade-in"><h2>ğŸ“Š SonuÃ§lar</h2><div class="results-stats"><span>Domain: <span class="val">'+td+'</span></span><span>Benzersiz URL: <span class="val">'+tu+'</span></span><span>Toplam ziyaret: <span class="val">'+tv.toLocaleString('tr-TR')+'</span></span></div></div><div class="saved-info hidden" id="savedInfo"></div><div class="action-row fade-in"><button class="action-btn save-btn" id="saveBtn" onclick="saveToLocal()">ğŸ’¾ Lokale Kaydet</button><button class="action-btn json-btn" id="jsonExportBtn" onclick="exportJSON()">ğŸ“¥ JSON Ä°ndir</button><button class="action-btn refresh-btn" onclick="refreshAnalysis()">ğŸ”„ GÃ¼ncelle</button>'+hasDelete+'</div><div class="tab-row fade-in"><button class="tab-btn active" onclick="setTab(\'all\',this)">ğŸ“‹ TÃ¼mÃ¼</button><button class="tab-btn" onclick="setTab(\'visited\',this)">âœ… Ziyaret Edilenler</button><button class="tab-btn" onclick="setTab(\'unvisited\',this)">ğŸš« Edilmeyenler</button><button class="tab-btn tab-fav" onclick="setTab(\'favorites\',this)">â­ SÄ±k KullanÄ±lanlar <span class="tab-count" id="favCount">('+favCount+')</span></button><button class="tab-btn tab-imp" onclick="setTab(\'important\',this)">ğŸ“Œ Ã–nemliler <span class="tab-count" id="impCount">('+impCount+')</span></button></div><div class="filter-row fade-in"><input type="text" class="search-input" id="searchInput" placeholder="ğŸ” Domain veya URL ara..." oninput="renderTabContent()"></div><div id="tabContent"></div>';
currentTab='all';updateSavedInfo();requestAnimationFrame(function(){renderTabContent()})}

function setTab(tab,btn){currentTab=tab;var btns=document.querySelectorAll('.tab-btn');for(var i=0;i<btns.length;i++)btns[i].classList.remove('active');btn.classList.add('active');renderTabContent()}
function deleteSavedAndReset(){if(!confirm('Lokal kayÄ±t silinecek. Emin misiniz?'))return;refreshAnalysis()}
function renderTabContent(){if(currentTab==='favorites'||currentTab==='important')renderFlatList();else renderDomainList()}

function renderFlatList(){var container=document.getElementById('tabContent');if(!container)return;var q=getSearchQuery();var markMap=currentTab==='favorites'?favorites:important;var items=[];for(var i=0;i<domainGroups.length;i++){var g=domainGroups[i];for(var j=0;j<g.paths.length;j++){var p=g.paths[j];if(!markMap[p.url])continue;if(q&&(p.title||'').toLowerCase().indexOf(q)===-1&&(p.url||'').toLowerCase().indexOf(q)===-1&&g.domain.toLowerCase().indexOf(q)===-1)continue;items.push({url:p.url,title:p.title,visitCount:p.visitCount,domain:g.domain,folders:p.folders})}}items.sort(function(a,b){return b.visitCount-a.visitCount});
if(items.length===0){container.innerHTML='<div class="no-match">'+(currentTab==='favorites'?'â­ HenÃ¼z sÄ±k kullanÄ±lan eklenmedi.':'ğŸ“Œ HenÃ¼z Ã¶nemli eklenmedi.')+'<br><span style="font-size:12px;color:var(--text-dim)">Listedeki linklerin yanÄ±ndaki '+(currentTab==='favorites'?'â˜†':'ğŸ“')+' ikonuna tÄ±klayarak ekleyebilirsiniz.</span></div>';return}
var removeFn=currentTab==='favorites'?'removeFav':'removeImp';var html='<div class="flat-list">';for(var i=0;i<items.length;i++){var it=items[i];var pvt=it.visitCount>0?it.visitCount.toLocaleString('tr-TR'):'0';var pvc=it.visitCount===0?'zero':'';var eu=escapeAttr(it.url).replace(/'/g,"\\'");html+='<div class="flat-item"><a href="'+escapeAttr(it.url)+'" target="_blank" rel="noopener" class="flat-info"><div class="flat-title">'+escapeHtml(it.title)+'</div><div class="flat-url">'+escapeHtml(getPathDisplay(it.url))+'</div><div class="flat-domain">ğŸŒ '+escapeHtml(it.domain)+'</div></a><div class="path-visits '+pvc+'">'+pvt+'</div><button class="remove-btn" onclick="'+removeFn+"('"+eu+"', event)"+'" title="Listeden KaldÄ±r">âœ•</button></div>'}html+='</div>';container.innerHTML=html}

function renderDomainList(){var container=document.getElementById('tabContent');if(!container)return;try{var q=getSearchQuery();var filtered=[];for(var i=0;i<domainGroups.length;i++){var g=domainGroups[i];if(currentTab==='visited'&&g.totalVisits<=0)continue;if(currentTab==='unvisited'&&g.totalVisits>0)continue;if(q){var match=g.domain.toLowerCase().indexOf(q)!==-1;if(!match){for(var j=0;j<g.paths.length;j++){var p=g.paths[j];if((p.title||'').toLowerCase().indexOf(q)!==-1||(p.url||'').toLowerCase().indexOf(q)!==-1){match=true;break}if(p.folders)for(var k=0;k<p.folders.length;k++){if(p.folders[k].toLowerCase().indexOf(q)!==-1){match=true;break}}if(match)break}}if(!match)continue}filtered.push(g)}
if(filtered.length===0){container.innerHTML='<div class="no-match">EÅŸleÅŸen domain bulunamadÄ±.</div>';return}
var max=Math.min(filtered.length,200);var html='<div class="domain-list">';for(var i=0;i<max;i++){var g=filtered[i];var vc=g.totalVisits===0?'zero':'';var vt=g.totalVisits>0?g.totalVisits.toLocaleString('tr-TR')+' ziyaret':'Yok';var ul=g.uniqueUrls===1?'1 yer imi':g.uniqueUrls+' yer imi';var ph='';for(var j=0;j<g.paths.length;j++){var p=g.paths[j];var ps=getPathDisplay(p.url);var pvc=p.visitCount===0?'zero':'';var pvt=p.visitCount>0?p.visitCount.toLocaleString('tr-TR'):'0';var isFav=!!favorites[p.url];var isImp=!!important[p.url];var eu=escapeAttr(p.url).replace(/'/g,"\\'");var fh='';if(p.folders&&p.folders.length>0){fh='<div class="path-folders">';for(var k=0;k<p.folders.length;k++){fh+='<span class="path-folder-tag" title="'+escapeAttr(p.folders[k])+'">ğŸ“ '+escapeHtml(p.folders[k])+'</span>'}fh+='</div>'}
ph+='<div class="path-item"><div class="path-marks"><button class="mark-btn fav-btn'+(isFav?' active':'')+'" data-url="'+escapeAttr(p.url)+'" onclick="toggleFav(\''+eu+"', event)"+'" title="SÄ±k KullanÄ±lan">'+(isFav?'â­':'â˜†')+'</button><button class="mark-btn imp-btn'+(isImp?' active':'')+'" data-url="'+escapeAttr(p.url)+'" onclick="toggleImp(\''+eu+"', event)"+'" title="Ã–nemli">'+(isImp?'ğŸ“Œ':'ğŸ“')+'</button></div><a href="'+escapeAttr(p.url)+'" target="_blank" rel="noopener" class="path-link"><div class="path-title">'+escapeHtml(p.title)+'</div><div class="path-url">'+escapeHtml(ps)+'</div>'+fh+'</a><div class="path-visits '+pvc+'">'+pvt+'</div></div>'}
html+='<div class="domain-group" data-domain="'+escapeAttr(g.domain)+'"><div class="domain-header" onclick="toggleDomain(this)"><div class="domain-rank">#'+(i+1)+'</div><div class="domain-info"><div class="domain-name">'+escapeHtml(g.domain)+'</div><div class="domain-meta"><span class="bm-count-label">'+ul+'</span></div></div><div class="domain-visits '+vc+'">'+vt+'</div><div class="domain-chevron">â–¶</div></div><div class="domain-body">'+ph+'</div></div>'}
if(filtered.length>200)html+='<div class="no-match">... ve '+(filtered.length-200)+' domain daha</div>';html+='</div>';container.innerHTML=html}catch(err){console.error('Render:',err);container.innerHTML='<div class="no-match">Render hatasÄ±: '+escapeHtml(err.message)+'</div>'}}

function getSearchQuery(){var el=document.getElementById('searchInput');return el?el.value.toLowerCase().trim():''}
function toggleDomain(el){el.closest('.domain-group').classList.toggle('open')}
</script>
</body>
</html>