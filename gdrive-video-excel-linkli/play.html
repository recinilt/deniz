<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Oynatıcı</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
    background: #0f172a;
    color: #e2e8f0;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 1.5rem;
  }
  .card {
    background: #1e293b;
    border-radius: 16px;
    padding: 2.5rem 2rem;
    max-width: 480px;
    width: 100%;
    text-align: center;
    box-shadow: 0 8px 32px rgba(0,0,0,0.4);
  }
  .icon { font-size: 3rem; margin-bottom: 1rem; }
  h1 { font-size: 1.4rem; font-weight: 600; margin-bottom: 0.5rem; color: #f8fafc; }
  .time-badge {
    display: inline-block;
    background: #2563eb;
    color: white;
    padding: 0.4rem 1rem;
    border-radius: 8px;
    font-family: 'Consolas', 'Courier New', monospace;
    font-size: 1.3rem;
    font-weight: 700;
    margin: 1rem 0;
  }
  .info {
    font-size: 0.95rem;
    color: #94a3b8;
    margin: 0.8rem 0;
    line-height: 1.5;
  }
  .key-group {
    margin: 1.2rem 0;
  }
  .key-group label {
    display: block;
    font-size: 0.9rem;
    color: #cbd5e1;
    margin-bottom: 0.4rem;
    font-weight: 500;
  }
  .key-input {
    width: 100%;
    max-width: 220px;
    padding: 0.6rem 1rem;
    border: 2px solid #475569;
    border-radius: 8px;
    background: #0f172a;
    color: #f1f5f9;
    font-size: 1.1rem;
    text-align: center;
    font-weight: 600;
    letter-spacing: 0.05em;
    outline: none;
    transition: border-color 0.2s;
  }
  .key-input:focus {
    border-color: #3b82f6;
  }
  .key-input::placeholder {
    color: #64748b;
    font-weight: 400;
  }
  .btn {
    display: inline-block;
    margin-top: 1rem;
    padding: 0.9rem 2rem;
    background: #2563eb;
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    text-decoration: none;
    transition: background 0.2s, transform 0.1s;
  }
  .btn:hover { background: #1d4ed8; transform: scale(1.02); }
  .btn:active { transform: scale(0.98); }
  .error {
    color: #f87171;
    font-size: 0.9rem;
    margin-top: 0.5rem;
  }
  .help {
    margin-top: 1.5rem;
    padding-top: 1rem;
    border-top: 1px solid #334155;
    font-size: 0.82rem;
    color: #64748b;
    line-height: 1.6;
  }
  .hidden { display: none; }
</style>
</head>
<body>

<div class="card">
  <div class="icon">&#x1F3AC;</div>
  <h1>Video Oynatıcı</h1>

  <div id="errorBox" class="hidden">
    <div class="info error" id="errorMsg"></div>
  </div>

  <div id="mainArea" class="hidden">
    <div class="time-badge" id="timeBadge"></div>
    <div class="info" id="infoText"></div>

    <div class="key-group">
      <label for="keyInput">Anahtar kelimeyi girin:</label>
      <input type="text" id="keyInput" class="key-input" placeholder="anahtar" autocomplete="off" autocapitalize="none" spellcheck="false">
    </div>
    <div id="keyError" class="error hidden"></div>

    <button class="btn" id="goBtn">&#x25B6;&#xFE0F; Videoya Git</button>
  </div>

  <div class="help">
    Anahtar kelimeyi girip butona bas&#x131;n.<br>
    Video taray&#x131;c&#x131;da a&#xE7;&#x131;lacakt&#x131;r.
  </div>
</div>

<script>
(function() {
  var p = new URLSearchParams(window.location.search);
  var _d = p.get('d');
  var _t = p.get('t');

  function showError(m) {
    document.getElementById('errorBox').classList.remove('hidden');
    document.getElementById('errorMsg').textContent = m;
  }
  function showKeyError(m) {
    var el = document.getElementById('keyError');
    el.textContent = m;
    el.classList.remove('hidden');
  }

  if (!_d) {
    showError('Video parametresi (d) eksik.');
    return;
  }

  if (_t) _t = _t.replace(/[^0-9hms]/g, '');

  /* Zaman goster */
  document.getElementById('mainArea').classList.remove('hidden');
  if (_t && _t !== '0s') {
    document.getElementById('timeBadge').textContent = '\u23F1 ' + fmtTime(_t);
    document.getElementById('infoText').textContent = 'Video ' + fmtTime(_t) + ' zamanında açılacak.';
  } else {
    document.getElementById('timeBadge').textContent = '\u25B6\uFE0F Baştan';
    document.getElementById('infoText').textContent = 'Video baştan açılacak.';
  }

  /* Enter tusu ile de calissin */
  document.getElementById('keyInput').addEventListener('keydown', function(e) {
    if (e.key === 'Enter') document.getElementById('goBtn').click();
  });

  /* BUTONA BASINCA — DECODE + REDIRECT */
  document.getElementById('goBtn').addEventListener('click', function() {
    document.getElementById('keyError').classList.add('hidden');

    var raw = document.getElementById('keyInput').value;
    if (!raw || !raw.trim()) {
      showKeyError('Lütfen anahtar kelimeyi girin.');
      return;
    }

    /* Turkce toLowerCase */
    var key = raw.trim().toLowerCase();

    /* Hex dogrula */
    var h = _d.replace(/[^0-9a-fA-F]/g, '');
    if (h.length < 20 || h.length % 2 !== 0) {
      showKeyError('Geçersiz video kodu.');
      return;
    }

    /* XOR decode */
    var id = '';
    for (var i = 0; i < h.length; i += 2) {
      var byte = parseInt(h.substr(i, 2), 16);
      var kc = key.charCodeAt((i / 2) % key.length);
      id += String.fromCharCode(byte ^ kc);
    }

    /* Temizle */
    id = id.replace(/[^a-zA-Z0-9_\-]/g, '');
    if (id.length < 10) {
      showKeyError('Hatalı anahtar. Tekrar deneyin.');
      return;
    }

    /* URL simdi olustur — charCode ile gizli */
    var a = [104,116,116,112,115,58,47,47];
    var b = [100,114,105,118,101,46,103,111,111,103,108,101,46,99,111,109];
    var c = [47,102,105,108,101,47,100,47];
    var e = [47,118,105,101,119];
    var u = '';
    for (var j = 0; j < a.length; j++) u += String.fromCharCode(a[j]);
    for (var j = 0; j < b.length; j++) u += String.fromCharCode(b[j]);
    for (var j = 0; j < c.length; j++) u += String.fromCharCode(c[j]);
    u += id;
    for (var j = 0; j < e.length; j++) u += String.fromCharCode(e[j]);
    if (_t) u += '?t=' + _t;

    window.location.href = u;
  });

  function fmtTime(t) {
    var h = 0, m = 0, s = 0;
    var a = t.match(/(\d+)h/), b = t.match(/(\d+)m/), c = t.match(/(\d+)s/);
    if (a) h = parseInt(a[1]); if (b) m = parseInt(b[1]); if (c) s = parseInt(c[1]);
    return pad(h) + ':' + pad(m) + ':' + pad(s);
  }
  function pad(n) { return n < 10 ? '0' + n : '' + n; }
})();
</script>
</body>
</html>
